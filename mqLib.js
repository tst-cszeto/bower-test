(function(){"use strict";var a={}.hasOwnProperty;this.CallbackContainer=function(){function b(){this._callbacks={},this._nextId=0}return b.prototype.addCallback=function(a){return this._nextId++,this._callbacks[this._nextId]=a,this._nextId},b.prototype.removeCallback=function(a){return this._callbacks.hasOwnProperty(a)?delete this._callbacks[a]:void 0},b.prototype.runCallbacks=function(b,c){var d,e,f,g,h,i,j;e=[],i=this._callbacks;for(f in i)a.call(i,f)&&(d=i[f],d(b),c&&e.push(f));for(j=[],g=0,h=e.length;h>g;g++)f=e[g],j.push(this.removeCallback(f));return j},b}()}).call(this),function(){"use strict";this.BaseWebSocketConnector=function(){function a(){this.ws=null,this.deferred=Q.defer(),this.messageCallbacks={},this.statusCallbacks={},this.oneTimeCallbacks={}}return a.prototype.connect=function(a,b){var c=this;return this.ws=new WebSocket(a),this.openCallback=b,this.ws.onopen=function(a){return c.onOpenHandler(a)},this.ws.onmessage=function(a){var b,d,e,f,g,h;return f=JSON.parse(a.data),g=c.getMessageInfo(f),d=g.channel,e=c.messageCallbacks,h=!1,"status"===g.type?e=c.statusCallbacks:"oneTime"===g.type&&(e=c.oneTimeCallbacks,h=!0),(b=e[d])?b.runCallbacks(f,h):void 0},this.ws.onclose=function(a){return c.closeCallback?(c.closeCallback(a),c.closeCallback=null):void 0},this.ws.onerror=function(a){return console.log("on error",a)}},a.prototype.disconnect=function(a){return this.closeCallback=a,this.ws.close(),this.ws=null},a.prototype.isConnected=function(){return this.ws?this.ws.readyState===WebSocket.OPEN:!1},a.prototype.getMessageInfo=function(a){var b,c,d;d={type:"message",channel:a.channel},a.consumerNames&&(d.type="oneTime"),b=a.content;try{b=JSON.parse(a.content),b.consumerNames&&(d.type="status",d.channel=b.channel)}catch(e){return c=e,d}return d},a.prototype.onOpenHandler=function(a){return this.openCallback&&(this.openCallback(a),this.openCallback=null),this.deferred.resolve(a)},a.prototype.sendMessage=function(a){var b,c=this;return this.ws.readyState===WebSocket.OPEN?this.ws.send(a):(b=this.deferred.promise,b.then(function(){return c.ws.send(a)}))},a.prototype.addCallback=function(a,b,c){var d;return d=this.messageCallbacks,"status"===c?d=this.statusCallbacks:"oneTime"===c&&(d=this.oneTimeCallbacks),d[a]||(d[a]=new CallbackContainer),d[a].addCallback(b)},a.prototype.removeCallback=function(a,b,c){var d,e;return e=this.messageCallbacks,"status"===c&&(e=this.statusCallbacks),(d=e[a])?d.removeCallback(b):void 0},a}()}.call(this),function(){"use strict";this.BaseMqService=function(){function a(a,b,c){this.url=a,this.userName=b,this.connector=c}return a.prototype.connect=function(a,b){return a=a||this.mqUrl,this.connector.connect(a,b)},a.prototype.disconnect=function(a){return this.connector.disconnect(a)},a.prototype.isConnected=function(){return this.connector.isConnected()},a.prototype.listenChannel=function(a,b,c,d){var e;return null==b&&(b=this.userName),null==c&&(c=0),a?(e={consumerName:b,action:"listen",isB64:c,channel:a},this.connector.sendMessage(JSON.stringify(e)),this.connector.addCallback(a,d,"message")):void 0},a.prototype.stopListenChannel=function(a,b){var c;return c={action:"stop_listen",channel:a},this.connector.sendMessage(JSON.stringify(c)),this.connector.removeCallback(a,b,"message")},a.prototype.getChannelStatus=function(a,b){var c;return c={action:"channel_status",channel:a},this.connector.sendMessage(JSON.stringify(c)),this.connector.addCallback(a,b,"oneTime")},a.prototype.monitorChannelStatus=function(a,b){var c;return c={action:"monitor_channel_status",channel:a},this.connector.sendMessage(JSON.stringify(c)),this.connector.addCallback(a,b,"status")},a.prototype.stopMonitorChannelStatus=function(a,b){var c;return c={action:"stop_monitor_channel_status",channel:a},this.connector.sendMessage(JSON.stringify(c)),this.connector.removeCallback(a,b,"status")},a.prototype.sendMessages=function(a,b,c,d){var e;return null==c&&(c=this.userName),null==d&&(d=0),a&&b?(b instanceof Array||(b=[b]),e={action:"send",isB64:d,messages:this.buildPayloadMessages(a,b,c)},this.connector.sendMessage(JSON.stringify(e))):void 0},a.prototype.sendMessagesToChannels=function(a,b,c){var d,e,f,g,h,i;if(null==b&&(b=this.userName),null==c&&(c=0),a){for(g=[],h=0,i=a.length;i>h;h++)d=a[h],e=a[d],g.concat(this.buildPayloadMessages(d,e,b));return f={action:"send",isB64:c,messages:g},this.connector.sendMessages(JSON.stringify(f))}},a.prototype.buildPayloadMessages=function(a,b,c){var d,e,f,g;for(e=[],f=0,g=b.length;g>f;f++)d=b[f],e.push({channel:a,source:c,content:d});return e},a}()}.call(this),function(){"use strict";angular.module("TstCoreServicesModule",[]).constant("DEFAULT_MQ_WS_URL","ws://localhost:8884/mq").constant("DEFAULT_USER","unknown")}.call(this),function(){"use strict";this.getBaseWebSocketConnectorInstance=function(){return new BaseWebSocketConnector},angular.module("TstCoreServicesModule").service("WebSocketConnector",this.getBaseWebSocketConnectorInstance)}.call(this),function(){"use strict";this.MqServiceProvider=function(){function a(){}return a.prototype.setMqConnector=function(a){return this.mqConnector=a},a.prototype.setMqUrl=function(a){return this.mqUrl=a},a.prototype.setUserName=function(a){return this.userName=a},a.prototype.getMqServiceInstance=function(a,b,c){return new BaseMqService(a,b,c)},a}()}.call(this),function(){"use strict";this.getMqServiceProviderInstance=function(){var a;return a=new MqServiceProvider,a.$get=a.getMqServiceInstance,a.$get.$inject=["DEFAULT_MQ_WS_URL","DEFAULT_USER","WebSocketConnector"],a},angular.module("TstCoreServicesModule").provider("MqService",this.getMqServiceProviderInstance)}.call(this);